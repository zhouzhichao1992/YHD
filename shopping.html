<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="css/iconfont1.css">
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/shopping.css">
    
</head>
<body>
    <div id="top_wrapper">
            <div class="top content">
                <a class="l1">
                    <i class="iconfont icon-xuanzhong"></i>
                    <span class="text">1号店首页&nbsp;</span>
                </a>
                <a class="l1">
                    <i class="iconfont icon-zuobiao"></i>
                    <span class="text">送货地址&nbsp;:</span>
                    <em>上海</em>
                </a>
                <div class="hd_topbar_right">
                    <div class="hd_unlogin">
                        <span class="hd_hi">Hi,请</span>
                        <a href="#" class="hd_login_link">登录&nbsp;</a>
                        <a href="#" class="hd_regist_link">&nbsp;注册</a>
                    </div>
                    <div class="hd_menu">
                        <a href="#">
                            <i class="iconfont icon-dingdan"></i><span class="text">我的订单</span></a>
                    </div>
                    <div class="hd_menu" >
                            <a href="#"></i><span class="text">客户服务</span><i class="iconfont icon-xjt"></i></a>
                    </div>
                    <div class="hd_menu" >
                            <a href="#"><i class="iconfont icon-shouji"></i><span class="text">APP下载</span></a>
                    </div>
                </div>
            </div>
    </div> 
    <div id="second_wrapper">
        <div class="second content">
            <div class="logo"><img src="shopping/54fcc955f4a8f2f8.png" alt=""></div>
            <div class="logo1"><img src="shopping/1658179ae841aa80.jpg" alt=""></div>
            <div class="search">
                <input type="text" value="" ><i class="iconfont icon-sousuo" ></i>
            </div>
            <div class="cart"><i class="iconfont icon-gouwuche"></i>购物车<span id="cartGoodsNum">0</span></div>
        </div>
    </div>
    <div id="nav_wrapper">
        <div class="nav content">
            <div class="nav1">
                <ul>
                    <li>超级单品</li>
                    <li>超级品牌</li>
                    <li>超级品类</li>
                </ul>
            </div>
            <div class="nav2">
                <ul>
                    <li>食品饮料</li>
                    <li>清洁纸品</li>
                    <li>清洁纸品</li>
                    <li>清洁纸品</li>
                    <li>清洁纸品</li>
                    <li>清洁纸品</li>
                    <li>清洁纸品</li>
                    <li><i class="iconfont icon-xjt">&nbsp;&nbsp;更多分类</i></li>
                </ul>
            </div>
        </div>
    </div>
    <div id="main_wrapper">
        <div class="main content">
            <div class="buying">
                <h1><i class="iconfont icon-xiaoxi">&nbsp;&nbsp;精选抢购</i></h1>
                <ul>
                    <li><i class="iconfont icon-huiyuan1">&nbsp;&nbsp;抢购中</i></li>
                    <li><i class="iconfont icon-dyy">&nbsp;&nbsp;即将开抢</i></li>
                    
                </ul> 
                <div><input type="checkbox" name="" id="">自营</div>
            </div> 
            <div class="goods">
                <!-- <ul>
                    <li>
                        <a href="#" class="pro_pic" target="_blank">
                            <img src="shopping/001.jpg" alt="">
                        </a>
                        
                        <p class="pro_title">
                            <a href="#" title="花王（Merries）纸尿裤 XL44片 加大号尿不湿（12-20kg）（日本原装进口）" target="_blank">
                            <span class="pro_tag">花王（Merries）纸尿裤 XL44片 加大号尿不湿（12-20kg）（日本原装进口）</span>
                            
                            </a>
                        </p>
                        
                        <p><span>￥69.0</span><span>￥119.0</span></p>
                        <p><a href="#">加入购物车</a></p>
                    </li> 
                </ul> -->
            </div>          
        </div>
    </div>
    <div id="footer_wrapper">
        <div class="footer content">
            <div class="f_top">
                        <a>
                            <img alt="" src="//d8.yihaodianimg.com/N05/M0B/39/F3/CgQI0lWskgmADBnsAAAPZvcSh3E68900.jpg" >
                            <b>正品保障</b>
                            <span>正品行货 放心选购</span>
                        </a>
                        <a>
                            <img alt="" src="//d6.yihaodianimg.com/N05/M09/96/23/ChEbulWsk4iADa_aAAAM544hHN818600.jpg" >
                            <b>满86包邮</b>
                            <span>满86元 免运费</span>
                        </a>
                        <a>
                            <img alt="" src="//d9.yihaodianimg.com/N07/M00/2D/8B/CgQIz1WslI-Adao3AAAN5b_ut2I80100.jpg" >
                            <b>售后无忧</b>
                            <span>7天无理由退货</span>
                        </a>
                        <a>
                            <img alt="" src="//d8.yihaodianimg.com/N09/M06/08/C8/ChEi11WsyiyALBbiAAAN9lEEK5M33200.jpg" >
                            <b>准时送达</b>
                            <span>收货时间由你做主</span>
                        </a>
            </div>
            <div class="f_center">
                <div class="words" >
                    <ul>
                            <li>新手入门</li>
                            <li><a href="//cms.yhd.com/cms/view.do?topicId=12" target="_blank">购物流程</a></li>
                            <li><a href="//cms.yhd.com/cms/view.do?topicId=17" target="_blank">会员制度</a></li>
                            <li><a href="//cms.yhd.com/cms/view.do?topicId=38" target="_blank">订单查询</a></li>
                            <li><a href="//cms.yhd.com/cms/view.do?topicId=10" target="_blank">服务协议及隐私说明</a></li>
                            <li><a href="//seo.yhd.com/sitelink/sitemap.html" target="_blank">网站地图</a></li>
                    </ul>
                    <ul>
                        <li>支付方式</li>
                        <li><a href="//cms.yhd.com/cms/view.do?topicId=25" target="_blank">货到付款</a></li>
                        <li><a href="//cms.yhd.com/cms/view.do?topicId=26" target="_blank">网上支付</a></li>
                        <li><a href="//cms.yhd.com/cms/view.do?topicId=28" target="_blank">礼品卡支付</a></li>
                        <li><a href="//cms.yhd.com/cms/view.do?topicId=29" target="_blank">其它支付</a></li>
                    </ul>
                    <ul>
                            <li>配送服务</li>
                            <li><a href="//cms.yhd.com/cms/view.do?topicId=21" target="_blank">配送进度查询</a></li>
                            <li><a href="//cms.yhd.com/cms/view.do?topicId=20" target="_blank">商品验货与签收</a></li>                    
                    </ul>
                    <ul>
                        <li>售后保障</li>
                        <li><a href="//cms.yhd.com/cms/view.do?topicId=31" target="_blank">退换货政策</a></li>
                        <li><a href="//cms.yhd.com/cms/view.do?topicId=36" target="_blank">发票制度</a></li>
                        <li><a href="//cms.yhd.com/cms/view.do?topicId=43" target="_blank">帮助中心</a></li>
                    </ul>
                </div>
                <!--footer 二维码 begin -->
                <div class="img" >
                    <div class="erweima">                       
                            <p>APP更优惠</p>
                            <a href="//app.yhd.com" target="_blank">
                                <img src="//img.yihaodianimg.com/front-homepage/index/images/qryhd.png?1=1" alt="APP更优惠二维码" style="background: none;">
                            </a>                       
                    </div>
                    <div class="erweima">
                       
                            <p>加微信查订单</p>
                            <img src="//img30.360buyimg.com/img/jfs/t15403/130/239695202/5772/891e9fb1/5a2798bbN479da3df.jpg" alt="加微信查订单二维码" style="background: none;">
                        
                    </div>
                </div>
            </div>
            <div class="f_bottum">

                        
                <p class="ft_footer_link">
                    <a href="http://www.miibeian.gov.cn/" target="_blank">沪ICP备16050468号</a>
                    |
                    <a href="//cms.yhd.com/cms/view.do?topicId=16" target="_blank">经营证照</a>
                    |
                    <a href="//d9.yihaodianimg.com/N10/M05/00/A9/ChEi2lkQGRaAfaeeAAIhVwT2TYo18400.jpg" target="_blank">互联网药品信息服务资格证</a>
                    |
                    <a target="_blank">违法和不良信息举报电话：0527-88100253</a>
                    |
                    <a href="//d9.yihaodianimg.com/N11/M04/76/1C/ChEwoVnfFfeAfzKUAAg9urXNqaA12000.jpg" target="_blank">沪B2-20170039</a>
                    |
                    <a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=31010502002939" target="_blank">沪公网安备 31010502002939号</a>
                    |
                    <a href="//seo.yhd.com/sitelink/sitelink.html" target="_blank">友情链接</a>
                    |
                    <a href="//cms.yhd.com/cms/view.do?topicId=105" target="_blank">出版物经营许可证</a>
                    |
                    <a href="//img30.360buyimg.com/img/jfs/t1/6492/18/11106/1876411/5c239337Ef050b204/c78bc70077a34bf2.jpg" target="_blank">增值电信业务经营许可证</a>
                    
                </p>
            
                <p>Copyright© 1号店网上超市 2007-2018，All Rights Reserved</p>
            
                <small id="footerbanner2LazyLoad" class="ft_pic_link">
                        <a href="http://net.china.com.cn/index.htm" target="_blank">
                            <img alt="" src="//d9.yihaodianimg.com/N01/M0A/95/FD/CgQCr1PQy1CAF7vaAABDexsiEYM24800.jpg" style="background: none;">
                        </a>
                        
                        <a href="http://shwg.dianping.com/index.html" target="_blank">
                            <img alt="" src="//d9.yihaodianimg.com/N08/M06/6C/9C/ChEi1VcfPl2AC1T8AAANFrEfJlw97300.jpg" style="background: none;">
                        </a>
                        
                        <a href="http://www.shjbzx.cn" target="_blank">
                            <img alt="" src="//d6.yihaodianimg.com/N10/M09/0E/1F/ChEi2lh171KAJrGlAAALl_uZt0E75600.jpg" style="background: none;">
                        </a>
                        
                        <a href="https://search.szfw.org/cert/l/CX20150608010268010812" target="_blank">
                            <img alt="" src="//d9.yihaodianimg.com/N08/M01/C7/7E/ChEi1FYXHcOAVk_WAAAL2r2-yfo10200.jpg" style="background: none;">
                        </a>
                        
                        <a href="https://ss.knet.cn/verifyseal.dll?sn=e13050631010040492h5mq000000&amp;ct=df&amp;a=1&amp;pa=500267" target="_blank">
                            <img alt="" src="//d9.yihaodianimg.com/N01/M03/A0/40/CgQCrlPYTqCASlHXAAAd82JE0eA31000.png" style="background: none;">
                        </a>
                        
                        <a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=31010502002939" target="_blank">
                            <img alt="" src="//img30.360buyimg.com/img/jfs/t16534/130/1965976230/19256/c267b386/5a706bb1Ne3eec0dd.png" style="background: none;">
                        </a>
                        
                </small>
             
            </div>
            
        </div>

    </div>
    
</body>
</html>
<script src="js/jquery.min.js"></script>
<script type="text/javascript">
	
	

	//点击btn登录，实现登录操作
	//登录成功后
	//login隐藏，goods和cart显示
	$(function(){
		
		
		var obj = {
			
			oGoods : $(".goods"), 
			oCart : $(".cart"), 
			cartGoodsNum : $("#cartGoodsNum")
		}
		new ShowGoods(obj).init();
	})
	
	class ShowGoods{
		constructor(obj){
			
			this.oGoods = obj.oGoods;//所有商品的窗口div
			this.oCart = obj.oCart;//购物车图标
			this.cartGoodsNum = obj.cartGoodsNum;
		}
		init(){//初始化所有功能 
			this.loading();
		}
		
		loading(){
			$.getJSON("json/good.json",function(res){
				var str = "";
				for (var i = 0; i < res.length; i++) {
					str += `
                        <ul>
                            <li>
                                <a href="#" class="pro_pic" target="_blank">
                                    <img src="shopping/${res[i].src}" alt="">
                                </a>
                                
                                <p class="pro_title">
                                    <a href="#" title="花王（Merries）纸尿裤 XL44片 加大号尿不湿（12-20kg）（日本原装进口）" target="_blank">
                                    <span class="pro_tag">${res[i].describe}</span>
                                    <input class="goodBid" type="hidden" value="${res[i].bid}"/>
                                    </a>
                                </p>
                                
                                <p><span>￥${res[i].price}</span><span>￥${res[i].price1}</span></p>
                                <p><a href="#">加入购物车</a></p>
                            </li> 
                        </ul>
					`;
				}
				this.oGoods.html(str);
				
				//加载商品操作
				this.addCart();
			
				//计算购物车数量
				this.computeNum();
				
				//点击购物车图标跳转到购物车页面
				this.goToCartPage();
				
			}.bind(this))
		}
		addCart(){
			//点击加入购物车按钮
			//alert(this.oGoods.find("p:last-child").html());
			var _this = this;
			this.oGoods.find("p:last-child").click(function(){
				//alert($(this).html());
				//[{"bid":002,num:1}]
				//把bid和num保存到localstorage或sessionstorage中
				var bid = $(this).parent().find(".goodBid").html();
				//alert(bid);
				var obj = [
					{
						"bid":bid,//bid
						"num":1//数量
					}
				];
				var objStr = JSON.stringify(obj);
				//document.cookie = "name=value " ===== localStorage
				//把要购买的商品id号和数据保存到购物车中去
				//需要获取购物车中的所有信息，
				
				//alert(localStorage.getItem(_this.userName+"goods"));
				if(localStorage.getItem(_this.userName+"goods")){//表示商品信息存在 
					//如果商品信息存在，判断当前选中的商品编号在原信息中是否有，
					//如果信息不存在，返回空，添加一条数据
					//如果有，说明是要对该商品添加一个数量
					//[{"bid":"002","num":2},{"bid":"001","num":1},{"bid":"001","num":1}]
					var storGoods = localStorage.getItem(_this.userName+"goods");
					var storGoodsJson = JSON.parse(storGoods);
					
					var flag = false;//表示原商品信息中不存在当前点击的这个商品
					for (var i = 0; i < storGoodsJson.length; i++) {
						if(storGoodsJson[i].bid == bid){//表示在原商品信息中存在当前点击的这个商品
							//对该商品添加一个数量
							storGoodsJson[i].num++;
							flag = true;
							break;
						}
					}
					if(!flag){//表示原商品信息中不存在当前点击的这个商品
						//添加一条数据
						var goodObj = {"bid":bid,"num":1}
						storGoodsJson.push(goodObj);
						
					}
					var storGoodsStr = JSON.stringify(storGoodsJson);
					//把添加好的这些商品信息保存到购物车中
					localStorage.setItem(_this.userName+"goods",storGoodsStr);
					
				}else{//商品信息不存在
					//如果不存在，说明是要添加一条该商品数据。
					localStorage.setItem(_this.userName+"goods",objStr);
				}
				
				//计算购物车商品数量
				_this.computeNum();
			})
		}
		computeNum(){
			//在购物车图标中显示数量cartGoodsNum
			if(localStorage.getItem(this.userName+"goods")){//有商品信息
				var storGoodsStr = localStorage.getItem(this.userName+"goods");
				var storGoddsJson = JSON.parse(storGoodsStr);
				var num = 0;
				for (var i = 0; i < storGoddsJson.length; i++) {
					num += Number(storGoddsJson[i].num);
				}
				this.cartGoodsNum.html(num);
			}
		}
		//点击购物车图标进入到购物车页面
		goToCartPage(){
			var _this = this;
			this.oCart.click(function(){
				location.href = "cart.html?userName=" + _this.userName;
			});
		}
	}
	
</script>